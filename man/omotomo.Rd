% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/omotomo.R
\name{omotomo}
\alias{omotomo}
\title{Run a full ionospheric tomography scan}
\usage{
omotomo(t0, t1, tomo = NULL, CALIBRATE = FALSE, verbose = FALSE)
}
\arguments{
\item{t0}{\link{POSIXct}
Start time of the analysis interval.}

\item{t1}{\link{POSIXct}
End time of the analysis interval.}

\item{CALIBRATE}{\link{logical} (default: \code{FALSE})
If \code{TRUE}, initializes the prior electron density field from the
background model only. If \code{FALSE}, uses results from the previous
tomography run (if available).}

\item{verbose}{\link{logical} (default: \code{FALSE})
If \code{TRUE}, prints progress messages and diagnostic information.}
}
\value{
Updates and returns the global \code{tomo} list, containing fields such as:
\itemize{
\item \code{tomo$domain} – 2D/3D grid definitions
\item \code{tomo$ne} – background, prior, predictive, and posterior electron density
\item \code{tomo$vtec} – vertical TEC fields derived from electron density
\item \code{tomo$obs_indirect} – processed indirect observations (GNSS, RO)
\item \code{tomo$dcb} – station and satellite DCB priors/posteriors
}
}
\description{
The \code{omotomo()} function orchestrates a full workflow for ionospheric
electron density tomography using multiple data sources (GNSS,
radio occultation, ionosondes, ISR, DIDBase). It prepares the model
domain, processes observational data, builds background and prior fields,
solves the posterior electron density model, and outputs results.
}
\details{
The function requires that a \code{config.R} file is present in the working
directory, which defines the global \code{tomo} parameter list including
file paths, model parameters, and analysis settings. It also requires
that \code{tomo$utils$parameter_file} exists and is valid.

The function performs the following main steps:
\enumerate{
\item Validates inputs and loads configuration files.
\item Prepares the 3D spatial grid and results directories.
\item Collects and processes multi-instrument observational data:
\itemize{
\item GNSS (Madrigal STEC data)
\item Radio occultation (STEC and profiles)
\item Ionosonde profiles
\item Incoherent scatter radar (ISR) profiles
\item DIDBase parameters
}
\item Extracts ionospheric peak parameters and smooths time series.
\item Builds 2D background fields using GAM interpolation in MODIP coordinates.
\item Constructs 3D Chapman electron density background and prior fields.
\item Performs data assimilation (Kalman filtering / Bayesian inversion) to
obtain the posterior 3D electron density field.
\item Computes VTEC maps and stores results in \code{tomo}.
\item Plots results and saves outputs to the configured results directory.
}

Errors are thrown with class \code{"omotomo_error"} if required inputs or files
are missing, invalid, or incorrectly specified.
}
\examples{
\dontrun{
t0 <- as.POSIXct("2021-11-10 09:05:00", tz = "UTC")
t1 <- as.POSIXct("2021-11-10 09:10:00", tz = "UTC")
tomo <- omotomo(t0, t1, CALIBRATE = TRUE, verbose = TRUE)
}

}
\seealso{
Functions used internally, such as \code{\link{get_madrigal_gnss_analysis_data}},
\code{\link{filter_gnss}}, \code{\link{get_domain_grid}},
\code{\link{solve_posterior}}.
}
